// Generated by CoffeeScript 1.6.3
var $;

$ = jQuery;

$.fn.extend({
  validate_popover: function(options) {
    var settings;
    settings = $.extend(true, {}, $.validator.popover_defaults, options);
    return this.validate(settings);
  }
});

$.extend($.validator, {
  popover_defaults: {
    onsubmit: true,
    success: function(error, element) {
      return $.validator.hide_validate_popover(element);
    },
    errorPlacement: function(error, element) {
      var message;
      message = error.html();
      this.beforeShowError.call(element.get(0), message);
      return $.validator.show_error(message, element);
    },
    beforeShowError: function() {}
  },
  hide_validate_popover: function(element) {
    var ele, _i, _len, _results;
    if (element.length > 1) {
      _results = [];
      for (_i = 0, _len = element.length; _i < _len; _i++) {
        ele = element[_i];
        _results.push($.validator.get_validate_popover(ele));
      }
      return _results;
    } else {
      return $.validator.get_validate_popover(element);
    }
  },
  show_error: function(message, element) {
    var $v_popover, left, left_adjust, offset, offset_adjust, top, top_adjust, _ref;
    $v_popover = $.validator.get_validate_popover(element);
    $('.popover-content', $v_popover).html(message);
    offset = $(element).offset();
    offset_adjust = $(element).data('popover-offset') || "0,0";
    _ref = offset_adjust.split(','), top_adjust = _ref[0], left_adjust = _ref[1];
    top = offset.top - 3 + parseInt(top_adjust);
    left = offset.left + $(element).width() + 20 + parseInt(left_adjust);
    return $v_popover.css({
      top: top,
      left: left
    }).show();
  },
  get_validate_popover: function(element) {
    var v_popover;
    v_popover = $(element).data('validate-popover');
    if (v_popover == null) {
      v_popover = $('<div class="popover right error-popover" id="validate-popover"><div class="arrow"></div><div class="popover-content"></div></div>').appendTo($('body'));
      $(element).data('validate-popover', v_popover);
    }
    return v_popover.hide();
  }
});
